<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Formulario de Registro</title>
  <style>
    :root {
          --color-blue-50: #f3f6fb;
          --color-blue-100: #e7edf6;
          --color-blue-150: #dbe5f1;
          --color-blue-200: #cedced;
          --color-blue-300: #a9c1df;
          --color-blue-400: #84a6d1;
          --color-blue-500: #5f8bc3;
          --color-blue-600: #4171ae;
          --color-blue-700: #386195;
          --color-blue-800: #2a4970;
          --color-blue-900: #213957;
          --color-blue-1000: #18293f;
          --color-gray-0: #ffffff;
          --color-gray-50: #f8f8f7;
          --color-gray-100: #f0f0ef;
          --color-gray-150: #e7e6e4;
          --color-gray-200: #d5d4d2;
          --color-gray-300: #bab7b5;
          --color-gray-400: #a29d9a;
          --color-gray-500: #8b8684;
          --color-gray-600: #74706d;
          --color-gray-700: #615d5c;
          --color-gray-800: #4d4947;
          --color-gray-900: #373433;
          --color-gray-1000: #222020;
          --color-green-50: #dff8ef;
          --color-green-100: #c3f1cf;
          --color-green-150: #8ce5a2;
          --color-green-200: #62db81;
          --color-green-300: #39d25f;
          --color-green-400: #2bbe50;
          --color-green-500: #28b04a;
          --color-green-600: #25a244;
          --color-green-700: #1f8639;
          --color-green-800: #1b7933;
          --color-green-900: #155d27;
          --color-green-1000: #0f411b;
          --color-jw-blue-50: #dee7f1;
          --color-jw-blue-100: #8ba3cc;
          --color-jw-blue-200: #7f9ac6;
          --color-jw-blue-300: #7491c1;
          --color-jw-blue-400: #6888bc;
          --color-jw-blue-500: #5c7eb7;
          --color-jw-blue-600: #5075b2;
          --color-jw-blue-700: #4a6da7;
          --color-jw-blue-800: #45659b;
          --color-jw-blue-900: #405e8f;
          --color-jw-blue-1000: #103245;
          --color-orange-50: #ffefe3;
          --color-orange-100: #ffddc1;
          --color-orange-150: #ffca9f;
          --color-orange-200: #ffb77d;
          --color-orange-300: #ffa55b;
          --color-orange-400: #ff9239;
          --color-orange-500: #ff7f17;
          --color-orange-600: #ff7606;
          --color-orange-700: #f46e00;
          --color-orange-800: #e36600;
          --color-orange-900: #c15700;
          --color-orange-1000: #9f4700;
          --color-red-50: #fce7e9;
          --color-red-100: #f8c9cd;
          --color-red-150: #f29ca4;
          --color-red-200: #eb5f6c;
          --color-red-300: #e53243;
          --color-red-400: #ca1a2a;
          --color-red-500: #bb1827;
          --color-red-600: #ac1624;
          --color-red-700: #9d1421;
          --color-red-800: #8e121e;
          --color-red-900: #700e17;
          --color-red-1000: #520a11;
          --color-yellow-50: #fff7da;
          --color-yellow-100: #fff0b8;
          --color-yellow-150: #ffeda7;
          --color-yellow-200: #ffe685;
          --color-yellow-300: #ffdf63;
          --color-yellow-400: #ffdb52;
          --color-yellow-500: #ffd430;
          --color-yellow-600: #ebba00;
          --color-yellow-700: #c99f00;
          --color-yellow-800: #a78400;
          --color-yellow-900: #856a00;
          --color-yellow-1000: #634f00;
    }
    html {
    font-family: NotoSans, Arial, "Arial Unicode MS", sans-serif;
    font-size: 14px; /* fuente tamaño menu */ 
    }
    body {
      background-color: #f9fbfd;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 90vh;
      margin: 0;
      position: relative;
      /*padding-bottom: 60px;  Para que el contenido no se solape con el footer */
    }
    form{
      /*padding: 10px;*/
      border-radius: 15px;
    }    
    .form-item {
      display: flex;
      align-items: center; /* Alinea las etiquetas con los campos verticalmente */
    }
   .form-container {
      background-color: white;
      /*padding: 20px;*/
      border-radius: 5px;
      box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.1);
      width: 350px;
      border: 0.5px solid var(--color-blue-50);
      margin-top: 10%;
    }
    .form-container h2 {
      text-align: center;
      margin-bottom: 20px;
      margin-top: 25px;
    }    
    .form-group {
      display: flex;
      flex-direction: row; /* Para que los contenedores de cada campo queden uno debajo de otro */
      /*gap: 15px;  Espacio entre los campos */
      margin-bottom: 10px;
    }
    .form-group-faceta {      
    display: flex;
    flex-direction: row-reverse;
    }
    .form-group-textarea {
      display: flex;
      flex-direction: column; /* Para que los contenedores de cada campo queden uno debajo de otro */
      gap: 5px; /* Espacio entre los campos */
      margin-bottom: 5px;
    }
    .form-group-inline {
      display: flex;
      align-items: center;
      margin: 15px;
      flex-direction: column; 
      text-align: center;	
    }
    .form-group-inline label {
      margin: 0;
    }
    .form-group-inline {
      margin-left: 10px;
    }
    label {
      display: block;
      margin-bottom: 10px;
      margin-top: 10px;	
      min-width: 100px; /* Ancho mínimo para las etiquetas */
      margin-right: 10px; /* Espacio entre la etiqueta y el campo */
      color:var(--color-gray-700)     
    }
    input[type="text"], 
      select {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--color-gray-200);
      font-size: 12px;
      box-sizing: border-box; /* Asegura que el padding no sobrepase el tamaño */
    }
    input[type="text"], textarea {
      flex-grow: 1; /* Para que los campos crezcan según el espacio disponible */
      padding: 8px; /* Añadir un poco de relleno para mejorar el aspecto */
      font-size: 12px;
      width: -webkit-fill-available;
      border: 1px solid #ccc;
      height: 50px;
    }
    input[type="text"], select, textarea :focus {
      border-color: var(--color-gray-200); /* Cambia a tu color preferido */
      outline: none; /* Opcional, elimina el borde por defecto del navegador */
      background-color: var(--color-blue-50);
    }
    input[type="checkbox"] {
      width: 100%;
      transform:scale(2);  
      margin-top: 10px; 
    }
    input[type="checkbox"]:checked {
    accent-color: var(--color-blue-500); /* Cambia el color del check */
    }
   
    input[type="submit"] {
      width: 100%;
      background-color: var(--color-blue-500);
      color: white;
      padding: 10px;
      border: none;
      cursor: pointer;
      font-size: 18px;
    }
    input[type="submit"]:hover {
      background-color: var(--color-blue-600);
    }
/* MENU DE PAGINA*/
 menu {
      margin-top: 0%;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: #f2f2f2;
      padding: 10px 0px;
      box-sizing: border-box;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 9px;
      color: #a7a5a5;
      border-bottom: 1px solid #dadce0;
    }
    menu a {
      color: #2d4a94;
      text-decoration: none;
    }
    menu a:hover {
      text-decoration: underline;
    }

/* FOOTER O PIE DE PAGINA    */
   footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background-color: #f2f2f2;
      padding: 10px 20px;
      box-sizing: border-box;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 9px;
      color: #a7a5a5;
      border-top: 1px solid #dadce0;
    }
    footer a {
      color: #2d4a94;
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }
    select {
      appearance: none; /* Elimina el estilo por defecto del select */
      -webkit-appearance: none;
      -moz-appearance: none;
      border: 1px solid #ccc; /* Borde estándar */
      padding: 10px;
      font-size: 12px;
      border-radius: 0px; /* Bordes rectos */
      background-color: white;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 6"><polygon points="0,0 5,6 10,0" style="fill: %238ba3cc;"/></svg>');
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 18px; /* Tamaño de la flecha */
    }

/* Ajusta el tamaño de la flecha y la posición del padding para que no se superponga al texto */
    select:focus {
      border-color: var(--color-blue-100); //* Color del borde al enfocar */
    }

/* Asegurarse de que el padding derecho no tape la flecha */
    select {
      padding-right: 30px; /* Espacio para la flecha */
    }
    span {
      font-size: 12px;
      color: var(--color-blue-100);
    }
    fieldset{
      border-color: var(--color-grey-50);
      border-style:hidden;
      border-width: 1px;
    }
    legend{
      display: flex;
      align-items: baseline;
      flex-wrap: nowrap;
      flex-direction: row;
      gap: 30px;
    }
    h3{
      margin-inline-end: 35px;
    }
    .hidden {
      display: none;
    }
/* Estilos para la barra de progreso */
    #progress-container {
      position: relative;
      width: 100%;
      height: 4px; /* Línea angosta */
      background-color:var(--color-blue-50); /* Color de fondo claro */
      top: 15px;
    }
    #progress-bar {
      width: 100%;
      height: 100%;
      background-color: var(--color-blue-500); /* Azul cielo */
      transition: width 0.4s ease;
    }
/* Para el mensaje de resultado */
    #status-message {
      
      font-size: 14px;
    }
    .thankYouMessage{    
      display: flex;
      flex-direction: column;
      flex-wrap: nowrap;
      align-items: center;
    }
    .response{
      display: flex;
      justify-content: center;
      flex-direction: row-reverse;
      flex-wrap: wrap;
      align-items: flex-start;
      padding: 20px;
    }
    label.GF{ 
    border: solid 1px var(--color-blue-400);
    padding: 2px;
    color: var(--color-blue-500);
    border-radius: 5px;
    min-width: fit-content;
    font-size: smaller;
    margin: 3px;
    }
    #encabezado{
      background-color: var(--color-blue-100);
      border-radius: 10px;
    }
    #headline{   
    display: flex;
    flex-wrap: nowrap;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    border-bottom: solid 1px var(--color-blue-100);
    margin-bottom: 15px;
    }
    
/* Estilo del icono de ayuda */
.help-icon {        
  border: solid 1px var(--color-blue-400);
  color: var(--color-blue-500);
  display: inline-block;
  width: 20px;
  height: 20px;
  background-color: var(--color-blue-100);
  text-align: center;
  border-radius: 25%;
  cursor: pointer;
  font-size: 12px;
  line-height: 20px;
  position: relative;
  margin: 5px;
}

.tooltip {
  visibility: hidden;
  width: 250px;
  background-color: var(--color-blue-100);
  color: var(--color-blue-500);
  text-align: center;
  border-radius: 5px;
  padding: 10px;
  position: fixed; /* Cambia a fixed */
  bottom: 20px; /* Aparecerá centrado en la parte inferior */
  left: 50%; /* Centra el tooltip horizontalmente en la pantalla */
  transform: translateX(-50%);
  z-index: 1;
  opacity: 0;
  transition: opacity 0.3s;
  border: 1px solid var(--color-blue-400);
}
/* Mostrar el tooltip al pasar sobre el icono */
.help-icon:hover .tooltip {
  visibility: visible;
  opacity: 1;
}
/* MOSTRAR MODAL PROCESAMIENTO*/
.modal {
  display: none; /* Oculto por defecto */
  position: fixed; /* Fijo en la pantalla */
  z-index: 1000; /* Por encima de todo */
  left: 0;
  top: 0;
  width: 100%; /* Ocupa toda la pantalla */
  height: 100%; /* Ocupa toda la pantalla */
  overflow: auto; /* Permite el desplazamiento si es necesario */
  background-color: rgba(0, 0, 0, 0.5); /* Fondo oscuro con transparencia */
}

.modal-content {
  background-color: white; /* Fondo blanco */
  margin: 15% auto; /* Centrado verticalmente */
  padding: 20px; /* Espaciado interno */
  border: 1px solid #888; /* Borde del modal */
  width: 300px; /* Ancho del modal */
  text-align: center; /* Centrar texto */
}
#Refresh #salir{
  display: none;
}
#menumsg{
    display: flex;
    gap: 25px;
}
#menucontainer{
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    align-content: space-between;
    align-items: flex-start;
    width: 100%;
}
#menutop{  
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: flex-start;
    gap: 50%;
    justify-content: space-between;
    width: 100%;
    padding: 0px 20px;
}

    
</style>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="icon" href="../Informes/img/MI.ico" type="image/x-icon">
  <link rel="shortcut icon" href="../Informes/img/MI.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="180x180" href="../Informes/img/MI180.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../Informes/img/MI32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../Informes/img/MI16.png">
  <link rel="manifest" href="manifest.json">

</head>

<body>  
  <menu id="menucontainer">
    <div id="menutop">
      <div id="menutopleft">©2024 EL JARDIN TOL-53140</div>
      <div id="menutopright">       
        <a href="#">Login</a> | 
        <a href="#">Registrese</a>       
      </div>
    </div>
    <!-- BARRA DE PROGRESO -->
    <div id="progress-container">
      <div id="progress-bar"></div>
    </div>
    <!-- END BARRA DE PROGRESO -->
   
  </menu>        
  <div class="form-container">
    <form id="myInform">   
      <!-- BARRA DE PROGRESO
      <div id="progress-container">
        <div id="progress-bar"></div>
      </div>
      END BARRA DE PROGRESO -->       
      <fieldset>
        <div id="headline">          
          <legend><h3>MI INFORME</h3></legend>

          <!-- ENCABEZADO RESULTADO CONSULTA DE GRUPO Y FACETA-->
           <!-- Mensaje de resultado -->
           <div id="status-message"></div>
          <div id="encabezado">
          <!-- Aquí podrías tener campos para mostrar el Grupo y la Faceta si lo deseas -->
              <div class="form-group-faceta">
                <label class="GF" id="grupo"><span> </span></label><label class="GF" id="faceta"><span > </span></label>
              </div>  
          </div>              
        </div>
        <!--CAMPO NOMBRE -->
        <div class="form-group">
          <label for="nombre">NOMBRE:</label>
            <select id="nombre" name="nombre" autocomplete="on" >
              <option value="" selected>Elige aquí tu nombre</option>
              <!-- Los nombres se llenarán aquí -->
            </select>            
        </div>

        <!--CAMPO CHECKBOX PARTICIPA-->
        <div class="form-group-inline">
          <fieldset id="fparticipa">
            <legend id="lparticipa">PARTICIPA:</legend>
            <input type="checkbox" name="participa" id="participa">
          </fieldset>
        </div>

        <!--CAMPO ESTUDIOS-->
        <div class="form-group hidden" id="estudiosContainer" >
          <label for="estudios">ESTUDIOS:</label>
          <input type="text" id="estudios" name="estudios" placeholder="Ingresa tus estudios" maxlength="5">
        </div>

        <!--CAMPO HORAS-->
        <div class="form-group hidden" id="horasContainer">
          <label for="horas">HORAS:</label>
          <input type="text" id="horas" name="horas" placeholder="Ingresa las horas" maxlength="5">
        </div>

        <!--CAMPO CREDITO-->
        <div class="form-group hidden" id="creditoContainer">
          <label for="credito">CREDITO:</label>
          <input type="text" id="credito" name="credito" placeholder="Horas: Otras formas de servicio">
          <!-- Icono de ayuda con tooltip dentro -->
            <span class="help-icon">?
              <!-- Tooltip que aparece al pasar el cursor sobre el icono -->
              <div class="tooltip">
              Por favor, ingresa las horas que has realizado en servicios de: ayuda a hermanos enfermos, LDC:Construccion, Preparativos en Asambleas...
              </div>
            </span>
        </div>

        <!--CAMPO COMENTARIOS-->
        <div class="form-group-textarea hidden" id="comentariosContainer">
          <label for="comentarios">COMENTARIOS:</label>
          <textarea id="comentarios" name="comentarios" rows="4" placeholder="Ingresa tus comentarios"></textarea>
        </div>

        <!--CAMPO BOTON SUBMIT ENVIAR-->
        <div class="form-group hidden" id="submitBtnContainer">
          <input type="submit" id="submitBtn" value="Enviar">
        </div>
      </fieldset>
        <!-- Modal de procesamiento -->
        <div id="processingModal" class="modal">
          <div class="modal-content">
            <h2>Procesando registro...</h2>
            <p>Por favor, espera mientras se envían los datos.</p>
          </div>
        </div>
    </form>

    <!-- AGRADECIMIENTOS POR EL REGISTRO-->
    <div id="thankYouMessage" style="display: none; text-align: center;">
      <!-- MUESTRA RESPUESTA DE HABER RECIBIDO EL REGISTRO DESDE APPSCRIPT -->
      <div id="response"></div>
      <img src="../Informes/img/MIGracias180.png" alt="Chulito Azul" style="width: 100px; height: 100px;">
      <h2>¡Recibimos tu informe!</h2>
      <div id="menumsg">
        <a href="#" id="Refresh" onclick="location.reload();">Nuevo Registro</a>
        <a href="#" id="Salir" onclick="window.close();">Salir</a>
      </div>
    </div>

    

  </div>

  <!-- FOOTER- PIE DE PAGINA-->
  <footer>
    <div>©2024 EL JARDIN TOL-53140</div>
    <div>       
      <a href="https://github.com/grupos53140/Informes/blob/main/CONDICIONES.md">Condiciones de uso</a> | 
      <a href="https://github.com/grupos53140/Informes/blob/main/PRIVACY.md">Política de privacidad</a>
    </div>
  </footer>

<!-- SECCION DE JAVASCRIPT-->
  <script>    
  // Variables para guardar los valores de grupo y faceta
  let grupo = {};
  let faceta = {};
  

  // Obtener y llenar el dropdown con los nombres
  fetch('https://script.google.com/macros/s/AKfycbxqs2vqHWcHp3zpT_89IhSoi9OhQVS7Mpy3UGfeZP2C82YxDcL9zYm5q8oNVN_lYsCz/exec')
    .then(response => response.json())
    .then(data => {
      const dropdown = document.getElementById('nombre');
      data.forEach(nombre => {
        let option = document.createElement('option');
        option.text = nombre;
        option.value = nombre; // Aseguramos que el valor sea el nombre seleccionado
        dropdown.add(option);
      });

    });

    // Escuchar cuando el usuario selecciona un nombre
  document.getElementById('nombre').addEventListener('change', function() {
      const selectedName = this.value;

     // Iniciar la barra de progreso
     iniciarBarraProgreso();
    mostrarMensaje("Consultando...");

    // Realizar la consulta para obtener grupo y faceta basados en el nombre
    fetch(`https://script.google.com/macros/s/AKfycbxqs2vqHWcHp3zpT_89IhSoi9OhQVS7Mpy3UGfeZP2C82YxDcL9zYm5q8oNVN_lYsCz/exec?nombre=${selectedName}`)
    .then(response => response.json())
      .then(data => {
         // Finalizar la barra de progreso
         finalizarBarraProgreso();
            mostrarMensaje("", true);

        // Guardar los valores de grupo y faceta en las variables
        grupo = data.grupo;
        faceta = data.faceta; 
        

        // Para mostra en el formulario en etiquetas span:
        document.getElementById('grupo').textContent = data.grupo;
        document.getElementById('faceta').textContent = data.faceta;

        // Para comprobar que se guardaron correctamente:
        console.log("Grupo:", grupo);
        console.log("Faceta:", faceta);
        // Aquí no se actualiza el HTML, solo se guardan en variables

        finalizarBarraProgreso(); // Asegurarse que la barra llega al 100%
        checkFaceta(faceta);
      });
  });

    function checkFaceta(faceta) {
      if (faceta === 'PUB'|| faceta==='PUB_NB') {
        
        document.getElementById('horasContainer').classList.add('hidden');
        document.getElementById('creditoContainer').classList.add('hidden');
        document.getElementById('estudiosContainer').classList.remove('hidden');
        document.getElementById('comentariosContainer').classList.remove('hidden');
        document.getElementById('submitBtnContainer').classList.remove('hidden');
        } else {
        document.getElementById('horasContainer').classList.remove('hidden');  
        document.getElementById('creditoContainer').classList.remove('hidden');  
        document.getElementById('estudiosContainer').classList.remove('hidden');
        document.getElementById('comentariosContainer').classList.remove('hidden');
        document.getElementById('submitBtnContainer').classList.remove('hidden');

      }
    }


 //////////////////////////////////////////////////////////////////////////////////////////////////////
 //BARRA DE TIEMPO DE ESPERA PARA LA CONSULTA DE GRUPO Y FACETA
 /////////////////////////////////////////////////////////////////////////////////////////////////////
 
 // Función para iniciar la barra de progreso
function iniciarBarraProgreso() {
    const progressBar = document.getElementById('progress-bar');
    let progreso = 0;
    const intervalo =100; // Intervalo en milisegundos (0.1 segundo)
    progressBar.style.transition = 'width 0s';

    // Crear un intervalo para aumentar progresivamente el ancho de la barra
    const idIntervalo = setInterval(() => {
        progreso += 5; // Incremento del 5% cada 0.1 segundos
        progressBar.style.width = `${progreso}%`;

        // Si la barra alcanza el 95%, detener el avance (esperar respuesta real)
        if (progreso >= 95) {
            clearInterval(idIntervalo);
        }
    }, intervalo);
}

// Función para finalizar la barra de progreso al 100%
function finalizarBarraProgreso() {
    const progressBar = document.getElementById('progress-bar');
    progressBar.style.transition = 'width 0.5s ease';
    progressBar.style.width = '0%';
   

}

// Mensaje de estado
function mostrarMensaje(mensaje, isSuccess = false) {
    const statusMessage = document.getElementById('status-message');
    if (isSuccess) {
        statusMessage.innerHTML = `<span style="color: var(--color-blue-500);">${mensaje} <i class="fas fa-check-circle"></i></span>`;
    } else {
        statusMessage.textContent = mensaje;
    }
}


    
////////////////////////////////////////////////////////////////////////////////////////////////////////
//ENVIAR LOS DATOS DEL FORMULARIO
//////////////////////////////////////////////////////////////////////////////////////////////////////
document.getElementById('myInform').addEventListener('submit', function(event) {
  event.preventDefault(); // Evitar que el formulario se envíe de manera convencional

      // Mostrar el modal
      document.getElementById("processingModal").style.display = "block";

      // Deshabilitar el botón de enviar
      event.target.disabled = true;

  // Obtener los valores del formulario
  const nombre = document.getElementById('nombre').value;
  const participa = document.getElementById('participa').checked ? "TRUE" : "FALSE";
  const estudios = document.getElementById('estudios').value || 0;
  const horas = document.getElementById('horas').value || 0;
  const credito = document.getElementById('credito').value || 0;
  const comentarios = document.getElementById('comentarios').value || "--";

  // Enviar los datos al AppScript usando fetch
  fetch('https://script.google.com/macros/s/AKfycbxqs2vqHWcHp3zpT_89IhSoi9OhQVS7Mpy3UGfeZP2C82YxDcL9zYm5q8oNVN_lYsCz/exec', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: new URLSearchParams({
      'grupo': grupo,
      'faceta': faceta,
      'nombre': nombre,      
      'participa': participa,
      'estudios': estudios,
      'horas': horas,
      'credito': credito,
      'comentarios': comentarios,
    })
  })

  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // MODAL PROCESANDO REGISTRO
  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////

 

  //MENSAJE RESPUESTA DEL APPSCRIPT DE GOOGLE SHEET
  .then(response => response.text())  // Leer la respuesta del AppScript
  .then(result => {
    console.log(result);  // Mostrar el resultado en la consola
    document.getElementById('response').textContent = result + "...Gracias!" ;  // Mostrar mensaje de éxito en la página
    document.getElementById('response').style.display='flex';
    document.getElementById('response').style.justifyContent='center';
    document.getElementById('response').style.flexDirection='row-reverse';
    document.getElementById('response').style.flexWrap='wrap';
    document.getElementById('response').style.alignItems='flex-start';
    document.getElementById('response').style.padding='20px';
   
    // Limpiar el formulario
    //document.getElementById('myInform').reset();  // Esto limpia todos los campos del formulario

    // Ocultar el modal una vez que se completa el procesamiento
    document.getElementById("processingModal").style.display = "none"; 

    // Volver a habilitar el botón de enviar
    event.target.disabled = false;

    // Ocultar el formulario y mostrar el mensaje de agradecimiento
    document.getElementById('myInform').style.display = 'none';
    document.getElementById('thankYouMessage').style.display ='flex';
    document.getElementById('thankYouMessage').style.flexDirection='column';
    document.getElementById('thankYouMessage').style.flexWrap='nowrap';
    document.getElementById('thankYouMessage').style.alignItems='center';
    document.getElementById('Refresh').style.display='block';

  })
  
  .catch(error => console.error('Error al enviar:', error));
  
});

  </script>

</body>
</html>